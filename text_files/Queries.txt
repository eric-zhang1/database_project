/* Find the type of all Equipment by MANUFACTURER released after YEAR (you choose how to designate the manufacturer, year). */
SELECT Type 
FROM Equipment_Main NATURAL JOIN Equipment_Type
WHERE MANUFACTURER = 'Manufacturer' AND YEAR > 'Year';

/* Give all the equipment and the date(s) of their checkout from a single MEMBER (you choose how to designate the member). */
SELECT Checkout_Date, Equipment_ID 
FROM CUSTOMER, Rental, Equipment_Main NATURAL JOIN Equipment_Type
WHERE CUSTOMER.User_ID = Rental.Customer_ID AND Rental.Equipment_ID = Equipment_Main.Serial_Number AND CUSTOMER.User_ID = 'Member_ID';

/* List all drones by type and its unique identifiers with 2 or less units held by a WAREHOUSE */
SELECT Model, Serial_Number  
FROM Drone_Main NATURAL JOIN Drone_Type, WAREHOUSE  
WHERE DRONE_MAIN.Warehouse_ID = WAREHOUSE.Warehouse_ID 
GROUP BY MODEL 
HAVING COUNT(MODEL) <= 2;

/* Give all the members that live more than 15 miles away from the warehouse who checked out equipment delivered by a particular DRONE (you choose how to designate the drone), as well as the equipment they checked out. */
SELECT Customer.Customer_ID, Rental.Equipment_ID 
FROM CUSTOMER, RENTAL  
WHERE CUSTOMER.UserID = RENTAL.Customer_ID AND Warehouse_Distance > 15 AND Delivery_Drone_ID = 'SERIAL_NUMBER';

/* Find the total number of unique drones that have picked up items checked out on certain Address (you choose how to designate the member address). */
SELECT COUNT (DISTINCT Pickup_Drone_ID)  
FROM RENTAL, CUSTOMER 
WHERE RENTAL.Customer_ID = CUSTOMER.User_ID AND CUSTOMER.Address = 'Address'; 

/* Find the member who has checked out the most equipment and the total number of items they have checked out. */
SELECT Customer_ID, COUNT (Equipment_ID) as Total_Equipment_Rented 
From RENTAL  
Group By Customer_ID
ORDER BY Total_Equipment_Rented DESC 
Limit 1;

/* Find the total quantity of Equipment purchases in the last 6 months by equipment type, provide the total dollar amount for each type and the average weight. */
SELECT ET.Type, COUNT(EM.Serial_Number), SUM(PO.Value), AVG(EM.Weight)  
FROM (Equipment_Main AS EM NATURAL JOIN Equipment_Type AS ET) JOIN PURCHASE_ORDER AS PO ON PO.Order_Number = EM.Order_Number  
WHERE PO.Actual_Arrival_Date >= DATE('now', '-6 months')  
GROUP BY ET.Type;